<script>
	function check_valid() {
		var labels = ['<%= all_labels -%>'] ;
		var valid = true;
		var invalid = "";

		$("input[type=radio]").removeClass('invalid'); // clear errors first

		//check if any input groups are not checked
		for (var i = 0; i < labels.length; i++) {
			var selector = 'input[data-tag=' + labels[i] + ']';

			if (!($(selector).is(':checked'))) {
				valid = false;
				invalid += " " + labels[i];
				$("#" + labels[i]).addClass('invalid');
				window.scrollTo(0, 0);
			}
		}

		if ($("#qualification_match_number").val() == "") {
			valid = false;
			$("#qualification_match_number").addClass('invalid');
			window.scrollTo(0, $("#qualification_match_number").position().top);
		}
		if ($("#qualification_table_number").val() == "") {
			valid = false;
			$("#qualification_table_number").addClass('invalid');
			window.scrollTo(0, $("#qualification_table_number").position().top);
		}

		if (!valid) {
			BootstrapDialog.alert({
									title: 'ERRORS!',
									message: "Make a selection for all items!",
									type: BootstrapDialog.TYPE_DANGER // <-- Default value is BootstrapDialog.TYPE_PRIMARY
							});
		} else {
			var special = special_validation();
			if (special != "") {
				//alert(special);
				BootstrapDialog.alert({
				            title: 'ERRORS!',
				            message: special,
				            type: BootstrapDialog.TYPE_DANGER // <-- Default value is BootstrapDialog.TYPE_PRIMARY
				            // callback: function(result) {
				            //     // result will be true if button was click, while it will be false if users close the dialog directly.
				            //     alert('Result is: ' + result);
				            // }
				        });
				valid = false;
			}
		}

		return valid;
	}

	function special_validation() {

		// if (input_value('bar_south') == 1) {
		// 	if (input_value('marker_color') == 0 && input_value('marker_ticks') != 0) {
		// 		$("#marker_color").addClass('invalid');
		// 		return "Must select dial location!";
		// 	}
		// 	if (input_value('marker_color') != 0 && input_value('marker_ticks') == 0) {
		// 		$("#marker_ticks").addClass('invalid');
		// 		return "Must select dial location!";
		// 	}
		// }
		//
		// var totalLoops = (input_value('robotics_loop_touch') == 0 ? 1 : 0) +
		// 				 (input_value('senses_touch') == 0 ? 1 : 0) +
		// 				 (input_value('correct_engine_loop_removed') == 1 ? 2 : 0) +
		// 				 (input_value('community_touch') == 0 ? 1 : 0) +
		// 				 (input_value('loops_on_scale'));
		//
		// if (totalLoops > 8) {
		// 	$("#robotics_loop_touch").addClass('invalid');
		// 	$("#senses_touch").addClass('invalid');
		// 	$("#correct_engine_loop_removed").addClass('invalid');
		// 	$("#community_touch").addClass('invalid');
		// 	$("#loops_on_scale").addClass('invalid');
		// 	return "Can't use more than 8 loops";
		// }

		// if (input_value('engine_installed') == 1 && input_value('car_folded_east_area') == 1) {
		// 	make_all_invalid("engine_installed", "car_folded_east_area");
		// 	return "Car can either be folded or have it's engine installed!";
		// }
		//
		// if (input_value('bars_in_w_transfer') + input_value('bars_not_in_w_transfer') > 15 ) {
		// 	make_all_invalid('bars_in_w_transfer', 'bars_not_in_w_transfer');
		// 	return "Too many Blue / Yellow bars!";
		// }
		//
		// if (input_value('bars_in_original_position') + input_value('bars_in_green_bin_or_landfill') + input_value('bars_elsewhere') > 12 ) {
		// 	make_all_invalid('bars_in_original_position', 'bars_in_green_bin_or_landfill', 'bars_elsewhere');
		// 	return "Too many Black bars!";
		// }
		//
		// if (input_value('compost_ejected') == 1 && input_value('compost_in_safety') == 1) {
		// 	make_all_invalid('compost_ejected','compost_in_safety');
		// 	return "Compost can be in or out of Safety!";
		// }

		// if (input_value('milk_and_manure') == 1 && input_value('milk_only') == 1) {
		// 	make_all_invalid('milk_and_manure', 'milk_only');
		// 	return "Milk and manure OR Milk only allowed!";
		// }
    //
		// if (input_value('bee_no_honey') == 1 && input_value('bee_honey_in_base') == 1) {
		// 	make_all_invalid('bee_no_honey', 'bee_honey_in_base');
		// 	return "No Honey in Beehive OR honey in Base!";
		// }
    //
		// if (input_value('prosthesis_not_held_by_ref') == 1 && input_value('prostheses_in_farm') == 1) {
		// 	make_all_invalid('prosthesis_not_held_by_ref', 'prostheses_in_farm');
		// 	return "Prosthesis on pet and not held by ref OR completely in Farm!";
		// }
    //
		// if (input_value('three_milk_in_base') == 1 && input_text('milk_on_ramp_option') !== 'None') {
		// 	make_all_invalid('three_milk_in_base', 'milk_on_ramp_option');
		// 	return "Milk must be IN BASE or ON RAMP - cannot be both!";
		// }

		 if (input_value('brick_ejected_in_planet') == 1 && input_value('brick_ejected_not_in_planet') == 1) {
		 	 make_all_invalid('brick_ejected_in_planet', 'brick_ejected_not_in_planet');
		 	 return "2x4 Brick can either be in Planet Area Or Not, not both!";
		 }

		 if (input_value('gas_core_sample_in_lander') == 1 && input_value('gas_core_sample_in_base') == 1) {
		 	 make_all_invalid('gas_core_sample_in_lander', 'gas_core_sample_in_base');
		 	 return "Gas Core Sample can either be in Lander Target Circle OR Base!";
		 }

		return "";
	}

	function input_value(tag) {
		return parseInt($('input:checked[data-tag=' + tag + ']').val());
	}

	function input_text(tag) {
		return $('input:checked[data-tag=' + tag + ']').val();
	}

	function make_invalid(tag) {
		$('#' + tag).addClass('invalid');
	}

	function make_all_invalid() {
		for (var i = 0; i < arguments.length; i++) {
			$('#' + arguments[i]).addClass('invalid');
		}
		window.scrollTo(0, $("#" + arguments[0]).position().top);
	}


	$(document).ready(function () {
		$("input[type=radio]").on('change', function (evt, myName) {
			var tag = $(evt.currentTarget).data('tag');
			$('#' + tag).removeClass('invalid');
			$("input[type=submit]").removeAttr('disabled');
		});

		$("input[type=text]").on('change', function (evt, element) {
			$(evt.currentTarget).removeClass('invalid');
			$("input[type=submit]").removeAttr('disabled');
		});
	});

</script>
